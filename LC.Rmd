---
title: "Learning Checks"
author: "Albert Y. Kim"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 1
    theme: cosmo
    highlight: tango
    df_print: paged
---

<style>
h1{font-weight: bold;}
h2{color: #3399ff;}
h3{color: #3399ff;}
slides > slide.backdrop {background: white;}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE, message = FALSE, warning = FALSE, fig.width=8, fig.height=4.5)
set.seed(76)
```


<!----------------------------------------------------------------------------->
# Lec08 - Wed 3/1: 5NG#3 Histograms + Facets

In ModernDive, LC4.14 thru 4.21 in <a target="_blank" class="page-link" href="https://rudeboybert.github.io/ModernDive/4-viz.html#histograms">Chapters 4.5-4.6</a>. 

## Discussion







<!----------------------------------------------------------------------------->
# Lec07 - Mon 2/27: 5NG#2 Linegraphs

In ModernDive, LC4.9 thru 4.13 in <a target="_blank" class="page-link" href="https://rudeboybert.github.io/ModernDive/4-viz.html#linegraphs">Chapter 4.4</a>. **Hint**: For LC4.10, Google "NYC Timezone" and note the number next to UTC. UTC stands for <a target="_blank" class="page-link" href="https://www.timeanddate.com/time/aboututc.html">Coordinated Universal Time</a>.


## Discussion

* **LC4.9**: Take a look at both the `weather` and `early_january_weather` data frames by running `View(weather)` and `View(early_january_weather)` in the console. In what respect do these data frames differ? *The rows of `early_january_weather` are a subset of `weather`.*
* **LC4.10**: The `weather` data is recorded hourly. Why does the `time_hour` variable correctly identify the hour of the measurement whereas the hour variable does not? *Because to uniquely identify an hour, we need the `year`/`month`/`day`/`hour` sequence, whereas there are only 24 possible `hour`'s. Note that in the case of `weather`, there is a timezone bug: the `time_hour` variable is off by 5 hours from the `year`/`month`/`day`/`hour` sequence, since the Eastern Time Zone is 5 hours off UTC.*
* **LC4.11**: Why should line-graphs be avoided when there is not a clear ordering of the horizontal axis? *Because lines suggest connectedness and ordering.*
* **LC4.12**: Why are line-graphs frequently used when time is the explanatory variable? *Because time is sequential: subsequent observations are closely related to each other.*
* **LC4.13**: Plot a time series of a variable other than temp for Newark Airport in the first 15 days of January 2013. *Humidity is a good one to look at, since this very closely related to the cycles of a day.*

```{r, echo=TRUE}
library(nycflights13)
library(dplyr)
library(ggplot2)
data(weather)
early_january_weather <- weather %>% 
  filter(origin == "EWR" & month == 1 & day <= 15)
ggplot(data = early_january_weather, aes(x = time_hour, y = humid)) +
  geom_line()
```










<!----------------------------------------------------------------------------->
# Lec06 - Fri 2/24: 5NG#1 Scatterplots

In ModernDive, LC4.1 thru 4.8 which include in <a target="_blank" class="page-link" href="https://rudeboybert.github.io/ModernDive/4-viz.html">Chapter 4</a>:

* Review Readings: Start of Chapter 4 to 4.2
* Chapter 4.3 to 4.3.1: 5NG#1 Scatterplots. Drill down on `geom_point()`
* Chapter 4.3.2: Two ways for dealing with **overplotting**:
    1. `alpha` to control **transparency**
    1. `geom_jitter()`: a variation of `geom_point()` where we add a little **jitter** (i.e. random noise) to the points to break log-jams

## Discussion

Load necessary data and packages:

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8, fig.height=4.5}
library(dplyr)
library(ggplot2)
library(nycflights13)
data(flights)
all_alaska_flights <- flights %>% 
  filter(carrier == "AS")
```

**LC4.1**: `flights` includes all flights, whereas `all_alaska_flights` only
includes Alaska Airlines flights. 


**LC 4.2-4.6**:

```{r, echo=TRUE}
ggplot(data=all_alaska_flights, aes(x = dep_delay, y = arr_delay)) + 
  geom_point()
```

* **4.2**: What are some practical reasons why `dep_delay` and `arr_delay` have a positive relationship? *The later a plane departs, typically the later it will arrive.*
* **4.3**: What does (0, 0) correspond to from the point of view of a passenger on an Alaskan flight?  Why do you believe there is a cluster of points near (0, 0)? *The point (0,0) means no delay in departure and arrival. From the passenger's point of view, this means the flight was on time. It seems most flights are at least close to being on time.*
* **4.4**: Create a similar plot, but one showing the relationship between departure time and departure delay. What hypotheses do you have about the patterns you see? *We now put `dep_time` as the `x`-aesthetic and `dep_delay` as the `y`-aesthetic*

```{r, echo=TRUE}
ggplot(data=all_alaska_flights, aes(x = dep_time, y = dep_delay)) + 
  geom_point()
```

**Hint:** Look at Alaska Airlines' route map. In fact, there are only two
flights paths: Flights 7 and 11 flying from Newark (EWR) to Seattle (SEA).

![alt text](assets/figure/alaska_airlines_map.png)


**LC 4.7-4.8**:

```{r alpha, warning=FALSE}
ggplot(all_alaska_flights, aes(x = dep_delay, y = arr_delay)) + 
  geom_point()
ggplot(all_alaska_flights, aes(x = dep_delay, y = arr_delay)) + 
  geom_point(alpha = 0.2)
```

* **4.7**: Why is setting the `alpha` argument value useful with scatter-plots? *It thins out the points so we address over-plotting. But more importantly it hints at the (statistical) **density** and **distribution** of the points: where are the points concentrated, where do they occur. We will see more about densities and distributions in Chapter 6 when we switch gears to statistical topics.*
* **4.8**: After viewing the above plot, give a range of arrival delays and departure delays that occur most frequently?  How has that region changed compared to when you observed the same plot without the `alpha = 0.2` set in lower plot? *The lower plot suggests that most Alaska flights from NYC depart between 12 minutes early and on time and arrive between 50 minutes early and on time.*



<!--
1. Compare the "transparency" vs "jitter" approach to dealing with over-plotting above. In this case, which do you prefer?
-->

```{r, echo=FALSE}
# ggplot(alaska_flights, aes(x = dep_delay, y = arr_delay)) + 
#   geom_point(alpha = 0.2)
# ggplot(alaska_flights, aes(x = dep_delay, y = arr_delay)) + 
#   geom_jitter(width = 30, height = 30)
```











<!----------------------------------------------------------------------------->
# Lec05 - Thu 2/23: More 5NG

**LC1-5** Consider the following data in tidy format:

```{r}
library(dplyr)
simple <-
  data_frame(
    A = c(1, 2, 3, 4),
    B = c(1, 2, 3, 4),
    C = c(3, 2, 1, 2),
    D = c("Hot", "Hot", "Cold", "Cold")
  )
simple %>% knitr::kable(format="markdown")
```

Letting

* the `x`-axis correspond to variable `A`
* the `y`-axis is variable `B`

draw using pen & paper the 5 graphics below:

1. A scatter plot
1. A scatter plot where the `color` of the points corresponds to `D`
1. A scatter plot where the `size` of the points corresponds to `C`
1. A line graph
1. A line graph where the `color` of the line corresponds to `D`


**Reach for the Stars #1:** A little ambitious right now, but see if you can tweak the code below to
create baby's first `ggplot2` graphic, graphic #1 above: just the scatter plot. I suggest you:

1. Create a new `.R` script file
1. Cut and paste the code below
1. Tweak the code in the `ggplot()` function from your Editor (not directly in console)

```{r, eval=FALSE, echo=TRUE}
library(dplyr)
library(ggplot2)

simple_ex <-
  data_frame(
    A = c(1, 2, 3, 4),
    B = c(1, 2, 3, 4),
    C = c(3, 2, 1, 2),
    D = c("Hot", "Hot", "Cold", "Cold")
  )
View(simple_ex)

ggplot(data=DATASETNAME, mapping=aes(x=VARIABLENAME, y=VARIABLENAME)) +
  geom_point()
```


**Reach for the Stars #2:** Even more ambitious right now, but see if you can tweak the same code to make graphic #2 above: a scatter plot where the `color` of the points corresponds to `D`. Hint:

* open the help file for `geom_point` by running `?geom_point` in the console
* scroll down to the *Aesthetics* section.

## Discussion

**LC1-5**: Chalk Talk

**Reach for the Stars #1:**

```{r, echo=FALSE}
library(dplyr)
library(ggplot2)

simple_ex <-
  data_frame(
    A = c(1, 2, 3, 4),
    B = c(1, 2, 3, 4),
    C = c(3, 2, 1, 2),
    D = c("Hot", "Hot", "Cold", "Cold")
  )
```


```{r, echo=TRUE}
ggplot(data=simple_ex, mapping=aes(x=A, y=B)) +
  geom_point()
```

**Reach for the Stars #2:**

```{r, echo=TRUE}
ggplot(data=simple_ex, mapping=aes(x=A, y=B, color=D)) +
  geom_point()
```

**Notice**:

1. We simply added `color=D` in the `aes()`thetic mapping statement!
1. How Cold gets mapped to red and Hot to blue. Computers don't know one color
represents heat better than another! How do you change these colors? We'll see later; let's keep things simple for now







<!----------------------------------------------------------------------------->
# Lec04 - Wed 2/22: 5NG

Based on the 5NG examples in today's slides

* **Learning Check 1**: Following the example of Napoleon's march, identify the elements of the Grammar of Graphics:
    1. identify the `data` variables being displayed and what type of variable they are
    1. identify the `aes()`thetic attribute of the `geom_`etric object the above `data` variables are being mapped to
* **Learning Check 2**: Answer the following questions:
    1. Does spending more on a movie yield higher IMDB ratings?
    1. Why are there drops in the number of flights?
    1. What are the smallest and largest visible heights and what do you think of them? Also, think of one graph improvement to better convey information about SF OkCupid users.
    1. Click <a target="_blank" class="page-link" href="http://www.datavizcatalogue.com/methods/images/anatomy/box_plot.png">here</a> for an explanation of boxplots. About what proportion of manual car models sold between 1984 and 2015 got 20 mpg or worse mileage?
    1. About how many babies were named "Hayden" between 1990-2014?
    
## Discussion

```{r, include=FALSE}
library(tidyverse)
library(lubridate)
library(knitr)
library(stringr)

library(nycflights13)
library(ggplot2movies)
library(okcupiddata)
library(babynames)
library(fueleconomy)
knitr::opts_chunk$set(cache=TRUE)
```

### 5NG#1: Scatterplot

```{r}
# Scatterplot i.e. bivariate plot
movies <- movies %>% 
  select(title, budget, rating)  

ggplot(data=movies, aes(x=budget, y=rating)) +
  geom_point() +
  labs(x="Movie Budget", y="IMDB Rating", title="IMDB Rating vs Budget")
```

Let's look at a random sample of 3 of the movies:

```{r}
# Scatterplot i.e. bivariate plot
movies %>% 
  filter(!is.na(budget)) %>% 
  sample_n(3) %>% 
  kable()
```

**Both variables are numerical**. Here are the components of the Grammar of Graphics:

`data` variable | `aes()`thetic attribute  | `geom_`etric object
------------- | ------------- | -------------
`budget` | `x` | `point` 
`rating` | `y` | `point` 

**Question: Does spending more on a movie yield higher IMDB ratings?**

```{r}
ggplot(data=movies, aes(x=budget, y=rating)) +
  geom_point() +
  labs(x="Movie Budget", y="IMDB Rating", title="IMDB Rating vs Budget") +
  geom_smooth(method="lm", se=FALSE)
```




### 5NG#2: Linegraph

```{r}
# Line graph
flights <- flights %>% 
  mutate(date=ymd(paste(year, month, day, sep="-"))) %>% 
  filter(month==1) %>% 
  group_by(date) %>% 
  tally()
  
ggplot(data=flights, aes(x=date, y=n)) + 
  labs(x="Date", y="Number of Flights", title="Number of Daily Flights from NYC in Jan 2013") +
  geom_line()
```


Let's look at a random sample of 3 of the dates:

```{r}
# Scatterplot i.e. bivariate plot
flights %>% 
  sample_n(3) %>% 
  kable()
```

**Both variables are numerical (dates are technically numerical since they are an abstraction of time)**. Here are the components of the Grammar of Graphics:

`data` variable | `aes()`thetic attribute  | `geom_`etric object
------------- | ------------- | -------------
`date` | `x` | `line` 
`n` | `y` | `line` 

**Note**: Why did we use `line` as the `geom_`etric object? Because lines suggest sequence/relationship, and points don't.

**Question: Why are there drops in the number of flights?** 2013/01/14 was a Monday.

```{r}
ggplot(data=flights, aes(x=date, y=n)) + 
  labs(x="Date", y="Number of Flights", title="Number of Daily Flights from NYC in Jan 2013") +
  xlim(as.Date(c("2013-01-14", "2013-01-20"))) +
  geom_line()
```


### 5NG#3: Histogram

```{r}
# Histogram
profiles <- profiles %>% 
  select(sex, height)

ggplot(data=profiles, aes(x=height)) +
  geom_histogram() +
  labs(x="height (in inches)", y="count", title="Heights of San Francisco OkCupid Users")
```

Let's look at a random sample of 3 of the users:

```{r}
# Scatterplot i.e. bivariate plot
profiles %>% 
  sample_n(3) %>% 
  kable(row.names=FALSE)
```

**Height is numerical**. Here are the components of the Grammar of Graphics:

`data` variable | `aes()`thetic attribute  | `geom_`etric object
------------- | ------------- | -------------
`height` | `x` | `histogram` 


**Note**: We'll see later there is no `y` aesthetic here, because there is
no explicit variable that maps to it, but rather it is computed internally.

**Question: What are the smallest and largest visible heights and what do you think of them? Also, think of one graph improvement to better convey information about SF
OkCupid users.**

```{r}
ggplot(data=profiles, aes(x=height)) +
  geom_histogram(binwidth = 1) +
  facet_wrap(~sex, nrow=1) +
  coord_cartesian(xlim=c(50, 80)) +
  labs(x="height (in inches)", y="count", title="Heights of San Francisco OkCupid Users")
```


### 5NG#4: Boxplot

```{r}
# Boxplot
vehicles <- vehicles %>% 
  mutate(
    trans2 = ifelse(str_sub(trans, 1, 1) == "M", "Manual", "Automatic"),
    name = paste(year, make, model)
    ) %>% 
  select(name, trans2, hwy) %>% 
  rename(trans=trans2)

ggplot(data=vehicles, aes(x=trans, y=hwy)) +
  geom_boxplot() +
  labs(y="Highway Mileage (miles/gallon)", x="Transmission Type", title="Highway Mileage of all Car Models 1984-2015") +
  coord_cartesian(ylim=c(5, 45))
```

Let's look at a random sample of 3 of the car year/make/model matchings:

```{r}
# Scatterplot i.e. bivariate plot
vehicles %>% 
  sample_n(3) %>% 
  kable()
```

**`trans` type is categorical, whereas `hwy` is numerical**. Here are the components of the Grammar of Graphics:

`data` variable | `aes()`thetic attribute  | `geom_`etric object
------------- | ------------- | -------------
`trans` | `x` | `boxplot` 
`hwy` | `y` | `boxplot` 

**Question: About what proportion of manual car models sold between 1984 and 2015 got 20 mpg or worse mileage?** Answer: 25%



### 5NG#5: Bar Plot

```{r}
# Bar Chart
babynames <- babynames %>% 
  mutate(decade = round(year / 10) * 10) %>% 
  filter(name=="Hayden" | name == "Carlos" | name == "Ethan") %>% 
  filter(decade >= 1990) %>% 
  group_by(name) %>% 
  summarise(n=sum(n))
  
ggplot(data=babynames, aes(x=name, y=n)) +
  geom_bar(stat="identity") +
  labs(x="Name", y="Count", title="Name Counts since 1990")
```


Let's look at all the data:

```{r}
# Scatterplot i.e. bivariate plot
babynames %>% 
  kable()
```

**Name is categorical**. Here are the components of the Grammar of Graphics:

`data` variable | `aes()`thetic attribute  | `geom_`etric object
------------- | ------------- | -------------
`name` | `x` | `bar` 
`n` | `y` | `bar` 


**Question: About how many babies were named "Hayden" between 1990-2014?** Answer: 1e+05 is R's shorthand notation for $1 \times 10^5 = 10,000$. To help me remember exponents, I just memorize that $1\times 10^6 = 1,000,000$ i.e. one million.

```{r, include=FALSE}
knitr::opts_chunk$set(cache=FALSE)
```










<!----------------------------------------------------------------------------->
# Lec03 - Mon 2/20: Tidy Data

Do the 16 Learning Checks in <a target="_blank" class="page-link" href="https://rudeboybert.github.io/ModernDive/3-tidy.html">Chapter 3 of ModernDive: Tidy Data</a>. You do not need to submit these.

## Discussion

**3.1** 3.2 is an example!

**3.2** Since there are three variable at play (Date, Price, Stock Name), there should be three columns!

```{r}
library(tidyverse)
data.frame(
  Date = as.Date('2009-01-01') + 0:4,
  Boeing = paste("$", c("173.55", "172.61", "173.86", "170.77", "174.29"), sep=""),
  Amazon = paste("$", c("174.90", "171.42", "171.58", "173.89", "170.16"), sep=""),
  Google = paste("$", c("174.34", "170.04", "173.65", "174.87", "172.19") ,sep="")
) %>% 
  gather(`Stock Name`, Price, -Date) %>% 
  knitr::kable()
```

**3.3 What does any ONE row in thd `flights` dataset refer to?**  Data on a flight. Not a flight path! Example: 

* a flight path would be United 1545 to Houston
* a flight would be United 1545 to Houston *2013/1/1 at 5:15am*


**3.4 What are some examples in this dataset of categorical variables? What makes them different than quantitative variables?**

Hint: Type `?flights` in the console to see what all the variables mean!

* Cateogorical:
    + `carrier` the company
    + `dest` the destination
    + `flight` the flight number. Even though this is a number, its simply a label. Example United 1545 isn't "less than" United 1714
* Quantitative:
    + `distance` the distance in miles
    + `time_hour` time

**3.5 What does `int`, `dbl`, and `chr` mean in the output above?** 

* `int`: integer. Used to count things i.e. a discrete value. Ex: the # of cars parked in a lot
* `dbl`: double. Used to measure things. i.e. a continuous value. Ex: your height in inches
* `chr`: character. i.e. text


**3.6 & 3.7** 19 columns (variables) and 336,776 rows (observations i.e. flights)

**3.8** `weather`, `planes`, `airports`, `airlines` data sets.

The observational units, i.e. what each row corresponds to:

* `weather`: weather at a given `origin` (EWR, JFK, LGA) for a given hour i.e. `year`, `month`, `day`, `hour`
* `planes`: a physical aircraft
* `airports`: an airport in the US
* `airlines`: an airline company

**3.9** See `?airports` help file

**3.10** Identification Variables

* In the `weather` example in LC3.8, the combination of `origin`, `year`, `month`, `day`, `hour`  are identification variables as they identify the observation in question.
* Anything else pertains to observations: `temp`, `humid`, `wind_speed`, etc.

**3.11 What are common characteristics of “tidy” datasets?** Described in Lecture slides.

**3.12 What makes “tidy” datasets useful for organizing data?** Organized way of viewing data. We'll see later that this format is required for the `ggplot2` and `dplyr` packages for data visualization and manipulation.

**3.13** There are 2 variables below, but what does each row correspond to? We don't know b/c there are no identification variables.

```{r}
students <- c(4, 6)
faculty <- c(2, 3)
data_frame("students" = students, "faculty" = faculty) %>% 
  knitr::kable()
```

**3.14** We need at least a third variable to identify the observations. For example a variable "Department".

**3.15** Sociology example

* Each row is a member of a university.
* Variables are the columns
* `TRUE` and `FALSE`. This is called a logical variable AKA a boolean variable. `1` and `0` can also be used

**3.16** We can easily `_join` them with other data sets! For example, can we join the `flights` data with the `planes` data?  We'll see this more in Chapter 4!



****









<!----------------------------------------------------------------------------->
# Lec02 - Thu 2/16: R Packages

You will be getting your first experience with:

* RStudio: i.e. The Dashboard
* R Packages: Extending the functionality
* `View()`: A command for viewing your data
* R Scripts: Text files to save your work
* Answering questions with data. In this case: baby name popularity


## Setting Up

As described in today's lecture slides: In RStudio (not DataCamp):

1. Install the `ggplot2`, `dplyr`, and `babynames` packages.
1. Load the `ggplot2`, `dplyr`, and `babynames` packages.


## `View()` Your Data

Load the `babynames` dataset in the RStudio viewer by running the following in 
the console. You should get in the habit of **always** `View()`ing your data first!

```{r, eval=FALSE}
View(babynames)
```

* Scroll through the viewer to get an overall feel for your data:
* Filter your data in the viewer
    + Click on the **Filter** button
    + Click in the white boxes under the variable names and
        + Play with any sliders for numerical variables: year, n, prop
        + Enter in values to view subsets of rows: sex, name


## R Scripts

There are two ways to run commands in the R console: Either

1. Typing them directly in the console and pressing enter (as you just did).
1. Saving them in a `.R` *R Script* and passing them to the console.

Do the following:

* In RStudio menu bar -> File -> New File -> R Script
* Save the file as `babynames`. Note:
    + A file extension `.R` gets added: `babynames.R`
    + You should see `babynames.R` in the File panel of RStudio:
* Cut/paste the contents of the grey block below into `babynames.R` and save it again.
* Run all the code in the console by highlighting it and pressing
    + Mac users: COMMAND+ENTER
    + PC users: CTRL+ENTER
* Comment on what you see


```{r, eval=FALSE}
# This bit of code loads packages:
library(ggplot2)
library(dplyr)
library(babynames)

# The code below shows the popularity trend for the name "Jeffrey" amongst 
# males. You do not need to understand this code for now; Just run it.
baby_name <- "Jeffrey"
baby_sex <- "M"

single_name <- babynames %>% 
  filter(name==baby_name & sex==baby_sex)

ggplot(data=single_name, aes(x=year, y=prop)) + 
  geom_line() +
  xlim(c(1880, 2014)) +
  ylim(c(0, NA)) +
  labs(x="Year", y="Proportion", title = paste("Prop of", baby_sex, "Named", baby_name))
```


## Today's Exercise

Investigate your hypothesized names that are "modern", "old-fashioned", and "back in vogue" by

* Changing **only** what gets assigned to
    + `baby_name`
    + `baby_sex`
* Running the appropriate lines of code in the console.



