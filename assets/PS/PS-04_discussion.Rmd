
---
title: "Problem Set 04"
author: "WRITE YOUR NAME HERE"
date: "Due Friday, October 14, 2016"
output:
  html_document
---


## Please Indicate

* Who you collaborated with. If no one, please indicate so: 
* Approximately how much time did you spend on this problem set: 
* What, if anything, gave you the most trouble: 


## Load all necessary packages

```{r, echo=FALSE, message=FALSE}
# Do not modify any code in this block, however you still need to run it in your
# console to load all the necessary packages.
library(ggplot2)
library(dplyr)

# OkCupid Data:
library(okcupiddata)
# Gapminder Data:
library(gapminder)
# For making pretty table outputs
library(knitr)
```


```{r, eval=FALSE, echo=TRUE}
library(ggplot2)
library(dplyr)
library(okcupiddata)
library(gapminder)
# For making pretty table outputs using kable()
library(knitr)
```




## Question 1: OkCupid Profile Data

We investigate a data set of about 60,000 San Francisco OkCupid users in 2012.


```{r, cache=TRUE, echo=TRUE}
data(profiles)
```


#### a)

Use a `geom_histogram()` to compare male and female heights, for 

* A **reasonable range of heights**. For example, a self-referenced height of 30 
inches is certainly someone joking around.
* An appropriate binning structure given the units of the data

Let's define "reasonable" as between 55 and 80 inches. i.e. people whose height is 
greater than or equal to 55 **AND** less than or equal to 80. 

```{r}
profiles <- filter(profiles, height>=55 & height <= 80)
```

Now let's plot the histogram. Note there are two ways to set the binning structure. By 
changing:

* The number of `bins` via `geom_histogram(bins=40)`
* The `binwidth` via `geom_histogram(binwidth=1)`

Since people's heights are in rounded inches (i.e. no decimal values), I argue setting
the `binwidth=1` inch is most appropriate to this data.

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.width=8, fig.height=4.5}
ggplot(data=profiles, aes(x=height)) +
  geom_histogram(binwidth = 1) +
  facet_wrap(~sex)
```



#### b)

1. How tall is a typical male?  **Around 70 inches, or 5'10''**
2. How tall is a typical female? **Around 65 inches, or 5'5''**
3. While the centers of both **distributions** might be different, what about their spread?  **Judging by the range of where the bulk of each histogram lies, it seems there is a little more variation in male heights**


#### c)

Within the male histogram there should be two large spikes. At what height is the
second spike occurring? What could be a sociological explanation for this phenomenon?

**Solution**: A bunch of dudes who are just under 72 inches = 6 feet, are rounding up. Check out this and other [Big Lies People Tell In Online Dating](https://blog.okcupid.com/index.php/the-biggest-lies-in-online-dating/)


#### d)

Create a boxplot comparing ages for males and females? What can you say about
the age distribution of females on San Francisco when compared to the males'?

**Solution**: Here we have

* a categorical variable `sex`
* a numerical variable `age`

So a boxplot is most appropriate:

```{r, warning=FALSE}
ggplot(data=profiles, aes(x=sex, y=age)) +
  geom_boxplot()
```

Let's ignore the female who is over 100:

```{r, warning=FALSE}
ggplot(data=profiles, aes(x=sex, y=age)) +
  geom_boxplot() +
  ylim(0,75)
```


There doesn't seem to any major differences in ages. Most men and women are between about 25 and 35.
Also the **median, not mean** age is about 30 for both men and women.







## Question 2: 

(Preview of chapter on data manipulation/wrangling) Using the same San Francisco
OkCupid data from Question 1, a research scientist produces the table 
**cross-classifying** a user's self-identified sexual orientation and their sex
below. The following code will:

1. Take all users' `profiles` data **then**
1. First `group` users' `_by` their self-identified sexual `orientation`, second `group` users' `_by` their `sex` **then**
1. Within each group, `summarise` that group with a `count` of the `n()`umber of people **then**
1. `mutate` existing variables to create new ones:
    + the `proportion` for each group: `count/sum(count)`
    + then `round()` the `proportion` variable to two `digits`.


```{r}
output_table <- profiles %>% 
  group_by(orientation, sex) %>% 
  summarise(count = n()) %>% 
  mutate(
    proportion = count/sum(count),
    proportion = round(proportion, digits=2)
    )
# Print table in clean format:
kable(output_table)
```

#### a) 

**Read the questions here**:

1. What proportion of the ~~59799~~ 59826 SF OkCupid users are female? What are some explanations for this?
2. What proportion of bisexual SF OkCupid users are female?
3. What proportion of female SF OkCupid users are gay?
4. If I randomly choose someone who self-identifies as straight, are they are more likely to be male or female?


**Write your answers here** (Do not insert blank lines between your answers, kind of like how I wrote the questions above): 

1. We type `(1994+1586+20509)/59799` in the console to find that the population is only about 40.2% female. This could be due to the:
    + Large gay male community
    + The large tech sector in SF that unfortunately suffers from a huge gender gap
2. 72%. Way more of the bisexuals are female. Note the table is presented such that the proportion **for each sexual orientation level** sums to 1. 
3. It is not 28%. We can't read this off the table, because the proportions aren't normalized this way. We have to compute it for ourselves: 
$$
\frac{\mbox{Number of gay females}}{\mbox{Number of females}} = \frac{1586}{1994+1586+20509} = 0.065 = 6.5\%
$$
4. Because 60% of users who self-identify as straight are male, they are more likely to be male.







## Question 3: Gapminder

Watch the following 20 minute [TED
Talk](https://www.ted.com/talks/hans_rosling_shows_the_best_stats_you_ve_ever_seen?language=en#t-801073)
by Hans Rosling on "The best stats you've ever seen." The human and international development data seen in the video is accessible in the `gapminder` data set within the `gapminder` package.



```{r, cache=TRUE, echo=FALSE}
# Do not modify any code in this block, however you still need to run it in your
# console to load the gapminder data set, which is in the gapminder R package.

# After loading the gapminder data set
# -Filter the data set to only consider observations for two years: 1952 & 2007
# -Rename the "pop" variable to "population"
data(gapminder)
gapminder <- 
  filter(gapminder, year==1952 | year==2007) %>% 
  rename(population=pop)
```


#### a) 

Recreate the scatterplot of "Child Survival (%)" over "GDP per capita ($)" for 
1980 seen in the video, but

* Making a comparison between 1952 and 2007
* Displaying "life expectancy" instead of "Child Survival"

Copy the template code below:

```{r, eval=FALSE}
# Note this code will not work in your console, it merely serves as a template
# that you will modify
ggplot(data=DATASETNAME, aes(AES1=VAR1, AES2=VAR2, AES3=VAR3, AES4=VAR4)) +
  geom_point() + 
  facet_wrap(~VAR5) +
  scale_x_log10() + 
  labs(x="WRITE INFORMATIVE LABEL HERE", y="WRITE INFORMATIVE LABEL HERE", title="WRITE INFORMATIVE TITLE HERE")
```

then paste it in the code block below, then replace anything in CAPS with the
appropriate terms:


**Solution**: let's quickly see what variables we have at our disposal:

```{r, eval=TRUE}
names(gapminder)
```

We associate

1. `gdpPercap` with `x`-values
1. `lifeExp` with `y`-values
1. `continent` with the `color` of the points
1. `population` size with the `size` of the points
1. `year` to the two `facet`

```{r}
ggplot(data=gapminder, aes(x=gdpPercap, y=lifeExp, color=continent, size=population)) +
  geom_point() + 
  facet_wrap(~year) +
  scale_x_log10() + 
  labs(x="GDP per Capita (US$, log-scale)", y="Life Expectancy (years)", title="1952 vs 2007 Life Expectancy")
```


#### b)

Describe two facts that would be of interest to international development
organizations.

**Solution**: While many trends are apparent, the ones that stuck out for me are:

1. Life expectancy for all countries as a whole increased drastically
1. Asia saw huge improvements in both wealth and life expectancy (the green dots moved to the top right), but unfortunately Africa not as much.
1. Two Asian countries exploded in population size.





